function checkInputHasValueForLabel(){$('.form-control:not(.simple-control)').each(function(){if($(this).val().length>0){$(this).parents('.form-group').addClass('active');}});}
function resetComplainInputFiles(){$('.file-input-group').removeClass('active').addClass('unactive');$('.file-input-group .file-input-img').val(null);}
let steps_list=$('.steps-list');function goToStep(has_next_step,next_item){let steps_length=parseInt(steps_list.attr('data-last-length'));if(next_item===0){trackEvent('buy_coins_goto_quantity','coins');}
if(next_item===1){trackEvent('buy_coins_goto_ea_account','coins');}
if(has_next_step){next_item+=1;}else{next_item-=1;}
steps_list.find('.step-block-item').removeClass('active').addClass('d-none');steps_list.find('.step-block-item').eq(next_item).addClass('active').removeClass('d-none');if(next_item>0){$('.btn-prev-step').removeClass('d-none');}else if(next_item<1){$('.btn-prev-step').addClass('d-none');}
$('.steps-items').removeClass('steps-active-0 steps-active-1 steps-active-2').addClass('steps-active-'+next_item);$('.steps-items>li').removeClass('active');for(let i=0;i<=next_item;++i){$('.steps-items>li').eq(i).addClass('active');}
if(next_item===steps_length){$('.btn-next-step').addClass('d-none');$('.btn-submit-step').removeClass('d-none');}else{$('.btn-next-step').removeClass('d-none');$('.btn-submit-step').addClass('d-none');}}
function fallbackCopyTextToClipboard(text){var textArea=document.createElement("textarea");textArea.value=text;textArea.style.top="0";textArea.style.left="0";textArea.style.position="fixed";document.body.appendChild(textArea);textArea.focus();textArea.select();try{var successful=document.execCommand('copy');var msg=successful?'successful':'unsuccessful';showMessageClipboard();}catch(err){}
document.body.removeChild(textArea);}
function showMessageClipboard(message){toastr["success"](message);}
function copyTextToClipboard(text,message){if(!navigator.clipboard){fallbackCopyTextToClipboard(text);return;}
navigator.clipboard.writeText(text).then(function(){showMessageClipboard(message);},function(err){});}
var main=function(){function close_menu(){$('.main-menu').removeClass('active');$('.hamburger-menu').removeClass('is-active').addClass('unactive');}
function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};};var loadCurrencySymbol=function(){$('.currency-symbol').text(window.currency_symbol);};var handleMenuResponsive=function(){$(document).on('click','.hamburger-menu.unactive',function(){toastr.remove();$('.main-menu').addClass('active');$('.hamburger-menu').removeClass('unactive').addClass('is-active');});$(document).on('click','.hamburger-menu.is-active',function(){close_menu();});$(document).on("click","body",function(e){var target=$(e.target);if(!target.is('.hamburger-menu, .hamburger-menu *,.main-menu, .main-menu *')){close_menu();}});};var handleBooleanSwitch=function(){function planSwitch($type){if($type==='monthly'){$('.sbc-plan-col[data-type="yearly"]').addClass('d-none');$('.sbc-plan-col[data-type="monthly"]').removeClass('d-none');}else if($type==='yearly'){$('.sbc-plan-col[data-type="monthly"]').addClass('d-none');$('.sbc-plan-col[data-type="yearly"]').removeClass('d-none');}}
$(document).on('click','.b-switch-true',function(){$(this).parents('.bool-switch').removeClass('bool-false').addClass('bool-true');$(this).parents('.switch-group').find('.form-group').removeClass('d-none');let $type=$(this).attr('data-type');if($type){planSwitch($type);}});$(document).on('click','.b-switch-false',function(){$(this).parents('.bool-switch').removeClass('bool-true').addClass('bool-false');$(this).parents('.switch-group').find('.form-group').addClass('d-none');let $type=$(this).attr('data-type');if($type){planSwitch($type);}});};var handlePasswordField=function(){$(document).on('click','.btn-eye.unactive',function(){let passwordGroup=$(this).parents('.password-fields-group');passwordGroup.find('.password-field .form-control').attr('type','text');passwordGroup.find('.btn-eye').removeClass('unactive').addClass('active');});$(document).on('click','.btn-eye.active',function(){let passwordGroup=$(this).parents('.password-fields-group');passwordGroup.find('.password-field .form-control').attr('type','password');passwordGroup.find('.btn-eye').removeClass('active').addClass('unactive');});};var handleChangeImage=function(){$('#avatar').on("change",function(event){$(this).parents('.form-group').removeClass('error-input')
$(this).parents('.form-group').find('.text-danger').remove();var file=$(this).prop('files')[0];var reader=new FileReader();let $this=$(this);if(file.name.match(/\.(jpg|jpeg|png|gif)$/)){if(file.size<2*1024*1204){reader.onload=function(e){$('.avatar-bg').css("background-image","url("+URL.createObjectURL(event.target.files[0])+")").removeClass('is-empty');};reader.readAsDataURL(file);}else{$this.parents('.avatar-group').after($('<span class="text-danger mt-0 text-sm text-red-600">الصورة يجب ان تكون اقل من 2MB</span>'));}}});};var handleDropDownMenu=function(){function closeDropdown(){$('.menu-dropdown-block').addClass('unactive').removeClass('active');}
$(document).on('click','.menu-dropdown-block.unactive',function(){$('.menu-dropdown-block').removeClass('unactive');$(this).addClass('active');});$(document).on('click','.menu-dropdown-block.active',function(){closeDropdown();});$(document).on("click","body",function(e){var target=$(e.target);if(!target.is('.menu-dropdown-block .btn-auth-user, .menu-dropdown-block .btn-auth-user *')){closeDropdown();}});};var handleAddToCart=function(){$(document).on('click','.add-to-cart',function(){let type=$(this).attr('data-type');let id=$(this).attr('data-id');let qty=$(this).attr('data-qty');let route=$(this).attr('data-route');let $formData={type:type,id:id,quantity:qty,};if(type=='bitaqat'){$formData={...$formData,'options':{'usage_type':'recharge_wallet'},};}
$.ajax({url:route,type:'POST',data:$formData,success:function(res){$('.btn-cart').addClass('active');toastr["success"](res.message);let coins=res?.data?.coins;let coinsItems=coins?.items.length;let cards=res?.data?.cards;let cardsItems=cards?.items.length;let sbc=res?.data?.sbc;let sbcItems=sbc?.items.length;let itemsCount=coinsItems+cardsItems+sbcItems;$('.cart-badge').text(itemsCount);window.location.reload();},error:function(res){window.handleCSRFError(res);if(res.status==403){toastr.error(window.second_item_cannot_be_added_to_the_cart)}
if(res.responseJSON.hasOwnProperty('errors')){$.each(res.responseJSON.errors,function(i,error){toastr.error(error[0])});}},});return false;});};function removeItemFromCart(route,type,id){$.ajax({url:route,type:'GET',data:{type:type,id:id,},success:function(res){toastr["success"](res.message);window.location.reload();},});}
var handleRemoveFromCart=function(){$(document).on('click','.btn-cart-delete',function(){$('#confirm-cart-delete').attr('data-type',$(this).attr('data-type'));$('#confirm-cart-delete').attr('data-id',$(this).attr('data-id'));$('#confirm-cart-delete').attr('data-route',$(this).attr('data-route'));$('#cart-delete-modal').cmodal({closeText:'',});return false;});};var confirmRemoveFromCart=function(){$(document).on('click','#confirm-cart-delete',function(){let type=$(this).attr('data-type');let id=$(this).attr('data-id');let route=$(this).attr('data-route');removeItemFromCart(route,type,id);return false;});};function updateCartItem(type,route,id,qty){$.ajax({url:route,type:'POST',data:{type:type,item_id:id,quantity:qty,item_method:'update-quantity',},success:function(res){toastr["success"](res.message);window.location.reload();},error:function(res){if(res.responseJSON.data['quantity']){$('#card-'+id).text(res.responseJSON.data['quantity'])}
window.handleCSRFError(res);if(res.responseJSON.hasOwnProperty('errors')){$.each(res.responseJSON.errors,function(i,error){toastr.error(error[0])});}},});}
function updateQuantityValueToBitaqat(qty){var $quantityInputField=$('.quantity-input-field');if($quantityInputField.length){$quantityInputField.val(qty);$('.bitaqat-price-value').text(qty*$('#price').val());}}
var handleUpdateItemCart=function(){$(document).on('click','.btn-cquantity',function(){let type=$(this).parents('.cart-quantity-block').attr('data-type');let id=$(this).parents('.cart-quantity-block').attr('data-id');let route=$(this).parents('.cart-quantity-block').attr('data-route');let jump=parseInt($(this).parents('.cart-quantity-block').attr('data-jump'));if(!jump)jump=1;let $input=$(this).parents('.cart-quantity-block').find('.cart-quantity-input');let minValue=parseFloat($input.attr('data-minvalue'));let maxValue=parseFloat($input.attr('data-maxvalue'));let qty=parseInt($input.text());let $parentWrap=$(this).parents('.cart-quantity');if($(this).hasClass('btn-cquantity-next')){qty+=jump;}else{qty-=jump;}
if(minValue&&qty<minValue){qty=minValue;return false;}
if(maxValue&&qty>maxValue)
qty=maxValue;if(qty===0){let cartDelete=window.cartDelete+'/'+id;removeItemFromCart(cartDelete,type,id);}
$input.text(qty);updateQuantityValueToBitaqat(qty);if(!$parentWrap.hasClass('not-change-qty-request')){updateCartItem(type,route,id,qty);}
return false;});$('.cart-quantity-input').on('input',debounce(function(){let type=$(this).parents('.cart-quantity-block').attr('data-type');let id=$(this).parents('.cart-quantity-block').attr('data-id');let route=$(this).parents('.cart-quantity-block').attr('data-route');let qty=parseFloat($(this).text());let minValue=parseFloat($(this).attr('data-minvalue'));let maxValue=parseFloat($(this).attr('data-maxvalue'));let $parentWrap=$(this).parents('.cart-quantity');if($(this).attr('data-maxvalue')&&qty<minValue){qty=minValue;$(this).text(qty);}
if($(this).attr('data-maxvalue')&&qty>maxValue){qty=maxValue;$(this).text(qty);}
updateQuantityValueToBitaqat(qty);if(!$parentWrap.hasClass('not-change-qty-request')){updateCartItem(type,route,id,qty);}},500));};var handleSteps=function(){$(document).on('click','.btn-next-step,.btn-prev-step',function(){let has_next_step=$(this).hasClass('btn-next-step');let next_item=steps_list.find('.step-block-item.active').index();goToStep(has_next_step,next_item);});};var handleInputWithLabel=function(){checkInputHasValueForLabel();$('.form-control:not(.simple-control,.control-has-placeholder)').focus(function(){$(this).parents('.form-group').addClass('active');});$('.form-control:not(.simple-control,.control-has-placeholder)').focusout(function(){if(!$(this).val()){$(this).parents('.form-group').removeClass('active');}});};var handleSMDropDown=function(){function closeSMDropdown(){$('.sm-dropdown-selected').addClass('unactive').removeClass('active');$('.sm-dropdown-list').removeClass('active');}
$(document).on('click','.sm-dropdown-selected.unactive',function(){closeSMDropdown();$(this).parents('.sm-dropdown-block').find('.sm-dropdown-list').addClass('active');$(this).addClass('active').removeClass('unactive');return false;});$(document).on('click','.sm-dropdown-selected.active',function(){closeSMDropdown();return false;});$(document).on("click","body",function(e){var target=$(e.target);if(!target.is('.sm-dropdown-selected, .sm-dropdown-selected *')){closeSMDropdown();}});};var handleAlertClose=function(){$(document).on('click','.btn-alert-close ',function(){$(this).parents('.alert').fadeOut(250);return false;});};var handleChangeSellCoinPaymentType=function(){$(document).on('change','input[name="payment_type"]',function(){let sell_payment_type_fields=$('.sell-payment-type-fields');sell_payment_type_fields.slideUp();$('.sell-payment-type-block').removeClass('active')
$(this).parents('.sell-payment-type-block').addClass('active').find('.sell-payment-type-fields').slideDown();sell_payment_type_fields.find('.text-danger').remove();});$('.sell-payment-type-block.active').find('.sell-payment-type-fields').slideDown();};var handleCustomerServiceModal=function(){$(document).on('click','.btn-customer-service:not(.is-disabled)',function(){if(window.whatsapp_enabled){$('#customer-service-modal').cmodal({closeText:'',});}
if(!window.whatsapp_enabled&&window.chat_enabled){window.fcWidget.open();}
return false;});};var handleStoreDownloadModal=function(){$(document).on('click','.btn-store-download',function(){$('#stores-modal').cmodal({closeText:'',});return false;});};var handleSelectPassport=function(){$('.fraud-input-file').on("change",function(event){$(this).parents('.form-group').find('.text-danger').remove();var file=$(this).prop('files')[0];let $this=$(this);let $label=$this.attr('data-label');let $size_msg=$this.attr('data-msg-size');let $type_msg=$this.attr('data-msg-type');if(file.name.match(/\.(jpg|jpeg|png|gif)$/)){if(file.size<4*1024*1204){$this.parents('.upload-input-area').find('.upload-file-name').text(file?.name);}else{$this.parents('.upload-input-area').find('.upload-file-name').text($label);$this.parents('.form-group').append('<span class="text-danger mt-2 text-validation">'+$size_msg+'</span>');$this.val('');}}else{$this.parents('.upload-input-area').find('.upload-file-name').text($label);$this.parents('.form-group').append('<span class="text-danger mt-2 text-validation">'+$type_msg+'</span>');$this.val('');}});};var handleExplanationsDropDown=function(){function closeDropdown(){$('.explanations-block').removeClass('active');$('.explanation-selected').removeClass('active').addClass('unactive');}
$(document).on('click','.explanation-selected.unactive',function(){$(this).removeClass('unactive').addClass('active');$('.explanations-block').addClass('active');});$(document).on('click','.explanation-selected.active',function(){closeDropdown();});$(document).on("click","body",function(e){var target=$(e.target);if(!target.is('.explanations-block .explanation-selected, .explanations-block .explanation-selected *')){closeDropdown();}});};var handleWhatsappSupportScroll=function(){var fixmeTop=$('#header').outerHeight();$(window).scroll(function(){var currentScroll=$(window).scrollTop();if($('.order-coin-details').length){var fixmeLeft=$('.order-coin-details').offset().left-($('.btn-support-whatsapp').outerWidth()/2);var offset=$('body').attr('dir')=='rtl'?'left':'right';if(currentScroll>=fixmeTop&&$(window).width()<=1020){$('.btn-support-whatsapp').addClass('scroll').css({[offset]:fixmeLeft+'px'});}else{$('.btn-support-whatsapp').removeClass('scroll').css({[offset]:0});}}});};var handleRating=function(){$(document).on('mouseover',".rating-star-list:not(.for-display)>.rating-star",function(){$(this).prevAll().addClass('active');$(this).addClass('active')
$(this).nextAll().removeClass('selected');$(this).nextAll().removeClass('active');});$(document).on('mouseleave',".rating-star-list:not(.for-display)>.rating-star",function(){let $rateValue=$(this).parents('.rating-start-group').find(".rating-value").val();if(($rateValue-1)>$(this).index()){$(this).parents('.rating-star-list').find(".rating-star").removeClass('selected');$(this).parents('.rating-star-list').find(".rating-star").removeClass('active');}else{$(this).parents('.rating-star-list').find(".rating-star").removeClass('active');}
for(let i=0;i<($rateValue);++i){$(this).parents('.rating-star-list').find(".rating-star").eq(i).addClass('selected');}});$(document).on('click','.rating-star-list:not(.for-display)>.rating-star',function(){$(this).prevAll().addClass('selected');$(this).addClass('selected')
$(this).parents('.rating-start-group').find(".rating-value").val($(this).index()+1);return false;});};var handleSelectDropDown=function(){function closeSelectDropdown(){$('.select-input').addClass('unactive').removeClass('active');$('.select-input-group').removeClass('active');}
$(document).on('click','.select-input.unactive:not(.is-disabled)',function(){closeSelectDropdown();$(this).parents('.select-input-group').addClass('active');$(this).addClass('active').removeClass('unactive');return false;});$(document).on('click','.select-input.active',function(){closeSelectDropdown();return false;});$(document).on("click","body",function(e){var target=$(e.target);if(!target.is('.select-input, .select-input *')){closeSelectDropdown();}});$(document).on('click','.select-input-list>.select-input-item',function(){let $value=$(this).attr('data-value');let $text=$(this).text();$(this).parents('.select-input-group').find('.select-input-value').val($value);$(this).parents('.select-input-group').find('.select-input-text').text($text);closeSelectDropdown();return false;});function setSelectValue(){$('.select-input-value').each(function(){let $value=$(this).val();if($value){let $text=$(this).parents('.select-input-group').find('.select-input-list>.select-input-item[data-value="'+$value+'"]').text();$(this).parents('.select-input-group').find('.select-input-text').text($text);}});}
setSelectValue();};var handleUploadFileInput=function(){function formatBytes(bytes,decimals=2){if(!+bytes)return '0 Bytes'
const k=1024
const dm=decimals<0?0:decimals
const sizes=['Bytes','KB','MB','GB','TB','PB','EB','ZB','YB']
const i=Math.floor(Math.log(bytes)/Math.log(k))
return `${parseFloat((bytes/Math.pow(k,i)).toFixed(dm))} ${sizes[i]}`}
$('.file-input-img').on("change",function(event){$(this).parents('.form-group').removeClass('error-input')
$(this).parents('.form-group').find('.text-danger').remove();let $size=$(this).attr('data-size');let $msg=$(this).attr('data-msg');var file=$(this).prop('files')[0];var reader=new FileReader();let $this=$(this);if(file.name.match(/\.(jpg|jpeg|png|gif)$/)){if(file.size<$size*1024*1204){reader.onload=function(e){$this.parents('.file-input-group').find('.file-input-uploaded-img>img').attr('src',URL.createObjectURL(event.target.files[0]));$this.parents('.file-input-group').find('.file-input-uploaded-name').text(file.name);$this.parents('.file-input-group').find('.file-input-uploaded-size-text').text(formatBytes(file.size));$this.parents('.file-input-group').removeClass('unactive').addClass('active');};reader.readAsDataURL(file);}else{$this.parents('.file-input-group').after($('<span class="text-danger mt-0 text-sm text-red-600">'+$msg+'</span>'));}}});$(document).on('click','.file-input-trash',function(){$(this).parents('.file-input-group').removeClass('active').addClass('unactive');$(this).parents('.file-input-group').find('.file-input-img').val(null);});};var handleCodeInputs=function(){$(document).on('keyup touchend','.code-input',function(e){var key=e.which||e.keyCode||e.charCode;var myLength=$(this).val().trim().length;if(key!==8&&myLength===1){$(this).parent().next('.form-input').find('.code-input').focus();}
if(key===8){$(this).parent().prev('.form-input').find('.code-input').focus();}});};var handleCopyClipboard=function(){$(document).on('click','.btn-copy-order-no',function(){let $text=$(this).parents('.order-no-media').find('.order-no-text').text();let $message=$(this).attr('data-msg');copyTextToClipboard($text,$message);return false;});};var handleInputNumbers=function(){$(document).on('keypress',".input-numbers",function(event){return /\d/.test(String.fromCharCode(event.keyCode));});};var handleWalletChargeCollapse=function(){$(document).on('click',".btn-wallet-new-charge.unactive",function(){$(this).removeClass('unactive').addClass('active');$('.wallet-charge-field-section').slideDown();return false;});$(document).on('click',".btn-wallet-new-charge.active",function(){$(this).removeClass('active').addClass('unactive');$('.wallet-charge-field-section').slideUp();return false;});};return{init:function(){loadCurrencySymbol();handleMenuResponsive();handleBooleanSwitch();handlePasswordField();handleChangeImage();handleDropDownMenu();handleAddToCart();handleRemoveFromCart();confirmRemoveFromCart();handleUpdateItemCart();handleSteps();handleInputWithLabel();handleSMDropDown();handleAlertClose();handleChangeSellCoinPaymentType();handleCustomerServiceModal();handleStoreDownloadModal();handleSelectPassport();handleExplanationsDropDown();handleWhatsappSupportScroll();handleRating();handleSelectDropDown();handleUploadFileInput();handleCodeInputs();handleSelectDropDown();handleUploadFileInput();handleCopyClipboard();handleInputNumbers();handleWalletChargeCollapse();}};}();jQuery(document).ready(function(){main.init();});